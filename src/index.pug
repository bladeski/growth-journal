doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    meta(name="description" content="A Progressive Web App for daily growth journaling and reflection")
    meta(name="theme-color" content="#A3C889")
    
    // PWA Meta Tags
    link(rel="manifest" href="./manifest.json")
    
    // iOS Meta Tags
    meta(name="mobile-web-app-capable" content="yes")
    meta(name="apple-mobile-web-app-status-bar-style" content="default")
    meta(name="apple-mobile-web-app-title" content="Growth Journal")
    link(rel="apple-touch-icon" href="./icons/icon-152-152.png")
    
    // Windows Meta Tags
    meta(name="msapplication-TileImage" content="./icons/icon-144-144.png")
    meta(name="msapplication-TileColor" content="#A3C889")
    
    title Growth Journal
    link(rel="preconnect" href="https://fonts.googleapis.com")
    link(rel="preconnect" href="https://fonts.gstatic.com" crossorigin)
    link(href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet")
    link(rel="stylesheet" href="./styles/styles.css")
    link(rel="preload" href="./styles/base.css" as="style" onload="this.onload=null;this.rel='stylesheet'")
    noscript
      link(rel="stylesheet" href="./styles/base.css")

    // Inline script to apply persisted theme preference before paint
    script.
      (function(){
        try{
          var pref = localStorage.getItem('gj_theme_preference');
          // expose to page JS so components can read preference synchronously
          try{ window.__gj_theme_pref = pref; }catch(e){}
          if(!pref || pref === 'system'){
            var mq = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)');
            if(mq && mq.matches) document.documentElement.setAttribute('data-theme','dark');
            else document.documentElement.removeAttribute('data-theme');
          } else if(pref === 'dark'){
            document.documentElement.setAttribute('data-theme','dark');
          } else {
            document.documentElement.removeAttribute('data-theme');
          }
        }catch(e){}
      })();
  body
    #app
      journal-app#journal-app
    // PWA UI elements (hidden by default). PWAManager will show them when appropriate.
    #pwa-ui
      .install-container(style="display:none;")
        button#install-button.install-button(aria-label="Install Growth Journal") Install Growth Journal
        button#install-ignore.button-ignore(aria-label="Ignore install prompt") Ignore
      div#update-notification(style="display:none;") New version available — refresh to update
      div#offline-indicator(style="display:none;") You are offline — some features may be limited
      span#online-status.status-online Online
    script(type="module" src="./index.ts")